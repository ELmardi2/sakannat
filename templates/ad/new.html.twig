{% extends 'base.html.twig' %}

{% block title %}Create your announce {% endblock %}

{% form_theme  form _self %}

{% block body %}
    <div class="container">
        <h1 class="text-center">Create And Add Your Announce Here <br>انشاء واضف اعلانك هنا</h1>

        {# Render the form here#}
        {{ form_start(form) }}
           {{ form_widget(form) }} 

           <button type="submit" class="btn btn-primary">Create your announce</button>
           
        {{ form_end(form) }}
    </div>
    
{% endblock %}


 {% block  _ad_images_widget  %}

    <p>Here You Can A dd your images</p>
    {{ form_widget(form) }}
    <div class="form-group">
        <button type="button" id="add-image" class="btn btn-primary">Add new image</button>
    </div>

 {% endblock %}

 {% block _ad_images_entry_row %}
    {{ form_widget(form) }}
 {% endblock %}
 
 {% block _ad_images_entry_widget %}
    <div class="form-group" id="block_{{ id }}">
        <div class="row">
            <div class="col-9">
                <div class="row">
                <div class="col">
                    {{ form_widget(form.url) }}
                </div>
                 <div class="col">
                    {{ form_widget(form.caption) }}
                 </div>
                </div>
            </div>
            <div class="col-3">
                <button button="button" data-action="delete" data-target="#block_{{ id }}" class="btn btn-danger">X</button>
            </div>
        </div>
    </div>
 {% endblock %}

 {% block javascripts %}
    <script>
        $('#add-image').click(function(){
            //return the number of input feilds
            const index = $('#ad_images div.form-group').length;

            //
            const tmpl = $('#ad_images').data('prototype').replace(/__name__/g,index);

            //add new inputs onclicl
            $('#ad_images').append(tmpl);

            //invoke fucntion delete
                handleDeleteButtons();    
        });

        function handleDeleteButtons(){
                $('button[data-action="delete"]').click(function(){
                    const target = this.dataset.target;
                    $(target).remove();
                });
            }
                handleDeleteButtons();
    </script>
 {% endblock %}